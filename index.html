<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<title data-rh="true">@ice/pkg-cli | 飞冰组件</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="@ice/pkg-cli | 飞冰组件"><meta data-rh="true" name="description" content="这是什么"><meta data-rh="true" property="og:description" content="这是什么"><link data-rh="true" rel="icon" href="https://img.alicdn.com/imgextra/i2/O1CN01jUf9ZP1aKwVvEc58W_!!6000000003312-73-tps-160-160.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/" hreflang="x-default"><script data-rh="true">function maybeInsertBanner(){window.__DOCUSAURUS_INSERT_BASEURL_BANNER&&insertBanner()}function insertBanner(){var n=document.getElementById("docusaurus-base-url-issue-banner-container");if(n){n.innerHTML='\n<div id="docusaurus-base-url-issue-banner" style="border: thick solid red; background-color: rgb(255, 230, 179); margin: 20px; padding: 20px; font-size: 20px;">\n   <p style="font-weight: bold; font-size: 30px;">Your Docusaurus site did not load properly.</p>\n   <p>A very common reason is a wrong site <a href="https://docusaurus.io/docs/docusaurus.config.js/#baseurl" style="font-weight: bold;">baseUrl configuration</a>.</p>\n   <p>Current configured baseUrl = <span style="font-weight: bold; color: red;">/</span>  (default value)</p>\n   <p>We suggest trying baseUrl = <span id="docusaurus-base-url-issue-banner-suggestion-container" style="font-weight: bold; color: green;"></span></p>\n</div>\n';var e=document.getElementById("docusaurus-base-url-issue-banner-suggestion-container"),s=window.location.pathname,r="/"===s.substr(-1)?s:s+"/";e.innerHTML=r}}window.__DOCUSAURUS_INSERT_BASEURL_BANNER=!0,document.addEventListener("DOMContentLoaded",maybeInsertBanner)</script><link rel="stylesheet" href="/assets/css/styles.33fa1472.css">
<link rel="preload" href="/assets/js/runtime~main.eabd1da0.js" as="script">
<link rel="preload" href="/assets/js/main.be272e74.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div id="docusaurus-base-url-issue-banner-container"></div><div role="region"><a href="#" class="skipToContent_XAN_">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="https://img.alicdn.com/imgextra/i1/O1CN01lZTSIX1j7xpjIQ3fJ_!!6000000004502-2-tps-160-160.png" alt="PKG-CLI" class="themedImage_Ox5S themedImage--light_oMmC"><img src="https://img.alicdn.com/imgextra/i1/O1CN01lZTSIX1j7xpjIQ3fJ_!!6000000004502-2-tps-160-160.png" alt="PKG-CLI" class="themedImage_Ox5S themedImage--dark_lcVh"></div><b class="navbar__title">PKG-CLI</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_nz8e toggle_Lv1h toggleDisabled_GCmF"><div class="toggleButton_K1DD" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_glq6"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_de_6"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_MMkk" aria-label="Switch between dark and light mode (currently light mode)"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_TEza"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_Zxel" type="button"></button><main class="docMainContainer_iQpp docMainContainerEnhanced_ztHE"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_l2nb"><div class="docItemContainer_jsOf"><article><div class="tocCollapsible_YiPO theme-doc-toc-mobile tocMobile_wWye"><button type="button" class="clean-btn tocCollapsibleButton_pPMW">On this page</button></div><div class="theme-doc-markdown markdown"><h1>@ice/pkg-cli</h1><h2 class="anchor anchorWithStickyNavbar_rm_O" id="这是什么">这是什么<a class="hash-link" href="#这是什么" title="Direct link to heading">​</a></h2><p><code>@ice/pkg-cli</code> 是飞冰团队对外开源的 NPM 包开发解决方案，同时也是 <a href="https://github.com/ice-lab/pkg-cli/tree/stable/0.x/packages/build-plugin-component" target="_blank" rel="noopener noreferrer">build-plugin-component</a> 的升级版本 。支持：</p><ul><li><strong>React 组件开发</strong></li><li><strong>库开发</strong></li></ul><p>有以下特性：</p><ul><li><strong>更快</strong>：代码使用 <a href="https://swc.rs/docs/configuration/swcrc" target="_blank" rel="noopener noreferrer">swc</a> 编译和压缩，提升数倍编译速度。</li><li><strong>支持 bundleless</strong>：默认支持 bundleless 产物。</li><li><strong>零配置</strong>：无需任何配置，提供 TypeScript 和 React JSX 支持。</li><li><strong>面向未来</strong>：提供 esnext 产物，可打包出面向现代浏览器支持的产物。</li><li><strong>更强大的预览能力</strong>：默认使用 <a href="https://docusaurus.io/" target="_blank" rel="noopener noreferrer">Docusaurus</a> 作为组件预览，文档生成方案。</li></ul><h2 class="anchor anchorWithStickyNavbar_rm_O" id="安装">安装<a class="hash-link" href="#安装" title="Direct link to heading">​</a></h2><p>在项目下使用 npm 或 pnpm 安装：</p><div class="codeBlockContainer_Gn_p language-shell theme-code-block"><div class="codeBlockContent_Hbc5 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> i @ice/pkg-cli --save-dev</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Or pnpm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">pnpm</span><span class="token plain"> i @ice/pkg-cli --save-dev</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><p>或通过以下脚本直接<strong>初始化</strong>一个示例项目：</p><div class="codeBlockContainer_Gn_p language-shell theme-code-block"><div class="codeBlockContent_Hbc5 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> init @ice/pkg react-component</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Or pnpm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">pnpm</span><span class="token plain"> init @ice/pkg react-component</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><blockquote><p><code>@ice/pkg-cli</code> 仅支持 esm 规范，支持的 Node 版本为 <code>^12.20.0 || ^14.13.1 || &gt;=16.0.0</code>。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_rm_O" id="使用">使用<a class="hash-link" href="#使用" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_rm_O" id="命令行">命令行<a class="hash-link" href="#命令行" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Gn_p language-shell theme-code-block"><div class="codeBlockContent_Hbc5 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 构建</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ pkg-cli build</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 实时编译 transform 产物</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ pkg-cli start</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 实时编译 bundle 产物</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ pkg-cli start --dist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 组件预览</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ pkg-cli start --doc</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_rm_O" id="编写代码限制">编写代码限制<a class="hash-link" href="#编写代码限制" title="Direct link to heading">​</a></h3><p><code>@ice/pkg-cli</code> 更推崇 <a href="https://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c" target="_blank" rel="noopener noreferrer">Pure ESM package</a>。因为我们更推荐使用 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules" target="_blank" rel="noopener noreferrer">esm 规范</a> 而非 <a href="https://nodejs.org/api/modules.html" target="_blank" rel="noopener noreferrer">commonjs</a>。因此带来了以下代码的书写限制：</p><ol><li><strong>添加文件后缀</strong></li></ol><p>比如，以下 TypeScript 代码：</p><div class="codeBlockContainer_Gn_p language-ts theme-code-block"><div class="codeBlockContent_Hbc5 ts"><pre tabindex="0" class="prism-code language-ts codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> add </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;./filename&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 引用相对路径的文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> mulitply </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;./directory&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 引用相对路径下的默认的 index.js 文件</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><p>在 esm 规范下，以上的写法属于<strong>不规范写法</strong>，<code>@ice/pkg-cli</code> 亦不支持上述写法。正确的写法如下：</p><div class="codeBlockContainer_Gn_p language-ts theme-code-block"><div class="codeBlockContent_Hbc5 ts"><pre tabindex="0" class="prism-code language-ts codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> add </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;./filename.js&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 引用相对路径的文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> mulitply </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;./directory/index.js&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 引用相对路径下的默认的 index.js 文件</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><blockquote><p>若主动开启 <a href="#autoPathcompletion">autoPathcompletion</a> 则在构建产物中会自动进行路径补全，该配置默认为 <code>false</code>。</p></blockquote><ol start="2"><li><strong>不支持 require、__dirname</strong> 等<a href="https://nodejs.org/dist/latest-v16.x/docs/api/esm.html#differences-between-es-modules-and-commonjs" target="_blank" rel="noopener noreferrer">用法</a></li></ol><p>不支持的方法或变量主要有：</p><ul><li><code>require</code>、<code>require.resolve</code> 和 <code>require.cache</code></li><li><code>__dirname</code> 和 <code>__filename</code></li></ul><h3 class="anchor anchorWithStickyNavbar_rm_O" id="package-exports">Package Exports<a class="hash-link" href="#package-exports" title="Direct link to heading">​</a></h3><p>目前，Package 导出依赖 <code>main</code>、<code>module</code> 和 <code>exports</code> 等导出配置。<code>@ice/pkg-cli</code> 默认的导出配置为：</p><div class="codeBlockContainer_Gn_p language-json theme-code-block"><div class="codeBlockContent_Hbc5 json"><pre tabindex="0" class="prism-code language-json codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;module&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;es/index.js&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;exports&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;esnext&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;./esnext/index.js&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;import&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;./es/index.js&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;default&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;./es/index.js&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><p>其中 <code>module</code> 配置可供给不支持 <code>exports</code> 的浏览器端构建工具使用（比如 webpack4）。</p><h4 class="anchor anchorWithStickyNavbar_rm_O" id="如何消费-esnext-产物">如何消费 esnext 产物<a class="hash-link" href="#如何消费-esnext-产物" title="Direct link to heading">​</a></h4><p>Node 和其他浏览器端工具并不<strong>默认</strong>消费 esnext 产物。以 <a href="https://webpack.js.org/" target="_blank" rel="noopener noreferrer">webpack5</a>，我们介绍如何在浏览器端使用 esnext 产物。</p><ol><li>通过 <a href="https://webpack.js.org/configuration/resolve/#resolveconditionnames" target="_blank" rel="noopener noreferrer">conditionNames</a> 使得 webpack 能够 resolve Package 的 esnext 产物。</li></ol><div class="codeBlockContainer_Gn_p language-js theme-code-block"><div class="codeBlockContent_Hbc5 js"><pre tabindex="0" class="prism-code language-js codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token literal-property property">resolve</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token literal-property property">conditionNames</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;esnext&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><ol start="2"><li>一般来说，esnext 产物需要根据应用的目标浏览器进行二次编译。比如：</li></ol><div class="codeBlockContainer_Gn_p language-js theme-code-block"><div class="codeBlockContent_Hbc5 js"><pre tabindex="0" class="prism-code language-js codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token literal-property property">module</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token literal-property property">rules</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token literal-property property">test</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;/\.js$/&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token literal-property property">use</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;swc-loader&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token literal-property property">include</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">resolve</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">precess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">cwd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;src&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">resolve</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">precess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">cwd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;node_modules/packageName&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_rm_O" id="编译-commonjs-的-packge-exports">编译 CommonJs 的 Packge Exports<a class="hash-link" href="#编译-commonjs-的-packge-exports" title="Direct link to heading">​</a></h4><p>若开启 <a href="#lib">lib</a> 配置，则 <code>@ice/pkg-cli</code> 会编译出 CommonJs 产物。此时，推荐的 Package Exports 配置如下：</p><div class="codeBlockContainer_Gn_p language-diff theme-code-block"><div class="codeBlockContent_Hbc5 diff"><pre tabindex="0" class="prism-code language-diff codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"> &quot;main&quot;: &quot;lib/index.js&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> &quot;module&quot;: &quot;es/index.js&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> &quot;exports&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   &quot;esnext&quot;: &quot;./esnext/index.js&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   &quot;import&quot;: &quot;./es/index.js&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">   &quot;require&quot;: &quot;./lib/index.js&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">   &quot;default&quot;: &quot;./es/index.js&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">   &quot;default&quot;: &quot;./lib/index.js&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token unchanged line"></span><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><blockquote><p>更多有关 Package Exports 的知识可阅读 <a href="https://webpack.js.org/guides/package-exports/#root" target="_blank" rel="noopener noreferrer">Webpack Package Exports</a> 和 <a href="https://nodejs.org/dist/latest-v16.x/docs/api/packages.html" target="_blank" rel="noopener noreferrer">Node Package</a>。</p></blockquote><h3 class="anchor anchorWithStickyNavbar_rm_O" id="自定义配置文件">自定义配置文件<a class="hash-link" href="#自定义配置文件" title="Direct link to heading">​</a></h3><p>可以为 <code>@ice/pkg-cli</code> 添加配置文件以修改或支持额外的能力。目前支持的配置文件有：</p><ul><li><code>build.json</code></li><li><code>build.config.js</code></li><li><code>build.config.ts</code></li><li><code>build.config.mjs</code></li><li><code>build.config.mts</code></li></ul><p>支持 TypeScript 文件 <code>build.config.ts</code> 进行配置，并引入 <code>defineConfig</code> 以获得更好的类型提示：</p><div class="codeBlockContainer_Gn_p language-ts theme-code-block"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_Xaeh">build.config.ts</div><div class="codeBlockContent_Hbc5 ts"><pre tabindex="0" class="prism-code language-ts codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> defineConfig </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@ice/pkg-cli&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">default</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">defineConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  minify</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><blockquote><p>在没有配置 <a href="https://nodejs.org/dist/latest-v16.x/docs/api/packages.html" target="_blank" rel="noopener noreferrer"><code>type=&quot;module&quot;</code></a> 的 Package 中， 配置文件 <code>build.config.[j|t]s</code> 仍推荐使用 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules" target="_blank" rel="noopener noreferrer">esm</a> 规范语法，而非 <a href="https://nodejs.org/dist/latest-v16.x/docs/api/modules.html" target="_blank" rel="noopener noreferrer">CommonJs</a> 规范语法。</p></blockquote><p>所有配置项如下：</p><h4 class="anchor anchorWithStickyNavbar_rm_O" id="alias">alias<a class="hash-link" href="#alias" title="Direct link to heading">​</a></h4><ul><li>类型 <code>object</code></li><li>默认值 <code>{}</code></li></ul><p>比如，将 <code>@</code> 指向 <code>./src/</code> 目录。</p><div class="codeBlockContainer_Gn_p language-ts theme-code-block"><div class="codeBlockContent_Hbc5 ts"><pre tabindex="0" class="prism-code language-ts codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> defineConfig </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@ice/pkg-cli&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">default</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">defineConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  alias</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string-property property">&#x27;@&#x27;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;./src/&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_rm_O" id="minify">minify<a class="hash-link" href="#minify" title="Direct link to heading">​</a></h4><ul><li>类型 <code>boolean</code></li><li>默认 <code>false</code></li></ul><p>设置为 <code>false</code> 可以禁用代码混淆能力。<code>@ice/pkg-cli</code> 使用 <a href="https://github.com/swc-project/swc" target="_blank" rel="noopener noreferrer">swc</a> 进行混淆。</p><h4 class="anchor anchorWithStickyNavbar_rm_O" id="define">define<a class="hash-link" href="#define" title="Direct link to heading">​</a></h4><ul><li>类型 <code>object</code></li><li>默认 <code>{}</code></li></ul><p>配置全局变量，在构建时会被静态替换。</p><div class="codeBlockContainer_Gn_p language-ts theme-code-block"><div class="codeBlockContent_Hbc5 ts"><pre tabindex="0" class="prism-code language-ts codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> defineConfig </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@ice/pkg-cli&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">default</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">defineConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  define</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    __APP_VERSION__</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;1.1.0&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_rm_O" id="babalplugins">babalPlugins<a class="hash-link" href="#babalplugins" title="Direct link to heading">​</a></h4><ul><li>类型 <code>array</code></li><li>默认 <code>[]</code></li></ul><p>可以使用 <a href="https://babeljs.io/docs/en/plugins/" target="_blank" rel="noopener noreferrer">babelPlugin</a> 来预处理一些代码片段。被 babelPlugin 处理过的代码，接下来仍会交给 swc 做进一步的处理。</p><div class="codeBlockContainer_Gn_p language-js theme-code-block"><div class="codeBlockContent_Hbc5 js"><pre tabindex="0" class="prism-code language-js codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> defineConfig </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@ice/pkg-cli&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">default</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">defineConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token literal-property property">plugins</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;transform-remove-console&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token string-property property">&quot;exclude&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;error&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;warn&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_rm_O" id="generatetypesforjs">generateTypesForJs<a class="hash-link" href="#generatetypesforjs" title="Direct link to heading">​</a></h4><ul><li>类型 <code>boolean</code></li><li>默认 <code>false</code></li></ul><p>为 JavaScript 代码生成类型文件。<code>@ice/pkg-cli</code> 默认为文件后缀为 <code>.ts</code> 生成类型文件。</p><p>如果使用 <a href="https://jsdoc.app/" target="_blank" rel="noopener noreferrer">jsdoc</a> 为 JavaScript 生成了类型注解，该配置会非常有效。</p><div class="codeBlockContainer_Gn_p language-js theme-code-block"><div class="codeBlockContent_Hbc5 js"><pre tabindex="0" class="prism-code language-js codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 下面通过 jsdoc 进行了类型注解</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @param {number} a</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @param {number} b</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @returns {number}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><p>若开启该配置，则生成如下 <code>.d.ts</code> 文件：</p><div class="codeBlockContainer_Gn_p language-ts theme-code-block"><div class="codeBlockContent_Hbc5 ts"><pre tabindex="0" class="prism-code language-ts codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">a</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">number</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> b</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">number</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">number</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_rm_O" id="lib">lib<a class="hash-link" href="#lib" title="Direct link to heading">​</a></h4><ul><li>类型 <code>boolean</code></li><li>默认 <code>false</code></li></ul><p><code>@ice/pkg-cli</code> 默认生成 <code>esm</code> 模块规范的代码。<code>esm</code> 模块已广泛应用于 Node（^12.20.0 || ^14.13.1 || &gt;=16.0.0）和 Browser 端（webpack 4 &amp; webpack 5 &amp; vite &amp; rollup）。</p><p>若需要生成 <code>commonjs</code> 规范的产物，可以配置该选项，则会生成 <code>lib</code> 文件目录，存放 <code>commonjs</code> 产物。</p><blockquote><p>相应地，可能需要修改 <a href="#Package-Exports">Package Exports</a> 导出的配置。</p></blockquote><h4 class="anchor anchorWithStickyNavbar_rm_O" id="autopathcompletion">autoPathcompletion<a class="hash-link" href="#autopathcompletion" title="Direct link to heading">​</a></h4><ul><li>类型 <code>boolean</code></li><li>默认 <code>false</code></li></ul><p>是否为<a href="#%E7%BC%96%E5%86%99%E4%BB%A3%E7%A0%81%E9%99%90%E5%88%B6">不规范的 esm 导入</a>提供自动路径补全。</p><h4 class="anchor anchorWithStickyNavbar_rm_O" id="plugins">plugins<a class="hash-link" href="#plugins" title="Direct link to heading">​</a></h4><ul><li>类型 <code>array</code></li><li>默认 <code>[]</code></li></ul><p><code>@ice/pkg-cli</code> 基于 <a href="https://github.com/ice-lab/build-scripts" target="_blank" rel="noopener noreferrer">build-scripts</a> 插件系统。更多内容请参考 <a href="#%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91">插件开发</a>。</p><h4 class="anchor anchorWithStickyNavbar_rm_O" id="umd">umd<a class="hash-link" href="#umd" title="Direct link to heading">​</a></h4><ul><li>类型 <code>object</code></li><li>默认 <code>{}</code></li></ul><p><code>@ice/pkg-cli</code> 提供过渡性的 <a href="https://github.com/umdjs/umd" target="_blank" rel="noopener noreferrer">umd</a> bundle 产物。配置开启，则生成 <code>dist</code> 文件目录，存放 bundle 产物。</p><p><code>umd</code> 配置有以下参数：</p><h5 class="anchor anchorWithStickyNavbar_rm_O" id="name">name<a class="hash-link" href="#name" title="Direct link to heading">​</a></h5><ul><li>类型 <code>string</code></li><li>默认 <code>package.name</code></li></ul><p>library 导出的名称，可以通过 <code>window[name]</code> 访问。默认为 <code>package.json</code> 配置的 <code>name</code> 字段。</p><h5 class="anchor anchorWithStickyNavbar_rm_O" id="filename">filename<a class="hash-link" href="#filename" title="Direct link to heading">​</a></h5><ul><li>类型 <code>string</code></li><li>默认 <code>index.js</code></li></ul><p>生成的文件名，默认为 <code>index.js</code>。</p><h5 class="anchor anchorWithStickyNavbar_rm_O" id="sourcemaps">sourceMaps<a class="hash-link" href="#sourcemaps" title="Direct link to heading">​</a></h5><ul><li>类型 <code>boolean | &#x27;inline&#x27;</code></li><li>默认 <code>false</code></li></ul><p>是否生成 sourcemap，这在代码调试的时候非常有用。</p><h5 class="anchor anchorWithStickyNavbar_rm_O" id="minify-1">minify<a class="hash-link" href="#minify-1" title="Direct link to heading">​</a></h5><ul><li>类型 <code>boolean | object</code></li><li>默认 <code>true</code></li></ul><p>混淆代码。也可以配置具体的 <a href="https://swc.rs/docs/configuration/minification" target="_blank" rel="noopener noreferrer">混淆策略</a>。<code>@ali/pkg-cli</code> 使用 swc 进行代码混淆。</p><h5 class="anchor anchorWithStickyNavbar_rm_O" id="env">env<a class="hash-link" href="#env" title="Direct link to heading">​</a></h5><ul><li>类型 <code>string | object</code></li><li>默认 <code>{ mode: &quot;usage&quot;, coreJs: &quot;3&quot;, targets: { chrome: 49, ie: 11 } }</code></li></ul><p>一次性配置 polyfills 和 browserlist。</p><p>若配置为 <code>es3 | es5 | es2015 | es2016 | es2017 | es2018 | es2019 | es2020 | es2021 | es2022</code>，则只会进行对应的语法转换。</p><p>若配置为：</p><div class="codeBlockContainer_Gn_p language-ts theme-code-block"><div class="codeBlockContent_Hbc5 ts"><pre tabindex="0" class="prism-code language-ts codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> defineConfig </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@ice/pkg-cli&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">default</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">defineConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  umd</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    env</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      mode</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;usage&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      coreJs</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;3&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      targets</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        chrome</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><p><code>@ice/pkg-cli</code> 会根据对应的 browserlist 进行对应的语法转换，以及添加对应的 polyfills。</p><h3 class="anchor anchorWithStickyNavbar_rm_O" id="插件开发">插件开发<a class="hash-link" href="#插件开发" title="Direct link to heading">​</a></h3><p><code>@ice/pkg-cli</code> 基于 <a href="https://github.com/ice-lab/build-scripts" target="_blank" rel="noopener noreferrer">build-scripts</a> 插件系统。通过 build-scripts 插件，可以极大地扩展 <code>@ice/pkg-cli</code> 的能力。</p><p>插件的使用如下：</p><div class="codeBlockContainer_Gn_p language-ts theme-code-block"><div class="codeBlockContent_Hbc5 ts"><pre tabindex="0" class="prism-code language-ts codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> defineConfig </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@ice/pkg-cli&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">default</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">defineConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  plugins</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;./customPlugin.ts&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_rm_O" id="修改默认配置">修改默认配置<a class="hash-link" href="#修改默认配置" title="Direct link to heading">​</a></h4><p>可以通过 <code>onGetConfig</code> API，可以修改 Package 编译的入口、出口等 <code>@ice/pkg-cli</code> 等默认配置：</p><div class="codeBlockContainer_Gn_p language-ts theme-code-block"><div class="codeBlockContent_Hbc5 ts"><pre tabindex="0" class="prism-code language-ts codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">plugin</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">api</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> onGetConfig </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> api</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> rootDir </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">onGetConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;component-es&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> config </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      outputDir</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">join</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">rootDir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;esm&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 将出口修改为 esm 文件夹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><p><code>@ice/pkg-cli</code> 注册三个 build-script 任务：</p><ul><li><code>component-es</code> - 主任务，默认启动</li><li><code>component-esnext</code> - 主任务，默认启动</li><li><code>component-lib</code> - 当开启 <a href="#lib">lib</a> 配置时启动</li><li><code>component-dist</code> - 当开启 <a href="#dist">dist</a> 配置时启动</li></ul><p>当不指定任务名（比如，指定 <code>component-es</code>）时，配置对所有任务生效。</p><div class="codeBlockContainer_Gn_p language-ts theme-code-block"><div class="codeBlockContent_Hbc5 ts"><pre tabindex="0" class="prism-code language-ts codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports">svelte</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;rollup-plugin-svelte&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">plugin</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">api</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> onGetConfig </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> api</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> rootDir </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 不指定 Task name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">onGetConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">config </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      rollupPlugins</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">svelte</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 编译 svelte 文件则会进行对应的</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><p>有以下参数可以配置：</p><h5 class="anchor anchorWithStickyNavbar_rm_O" id="entry">entry<a class="hash-link" href="#entry" title="Direct link to heading">​</a></h5><ul><li>类型 <code>string</code></li><li>默认值 <code>./src | ./src/index.[j|t]s</code></li></ul><p>配置组件编译的入口。</p><table><thead><tr><th>任务</th><th>默认值</th></tr></thead><tbody><tr><td>component-es</td><td><code>./src</code></td></tr><tr><td>component-esnext</td><td><code>./src</code></td></tr><tr><td>component-lib</td><td><code>./src</code></td></tr><tr><td>component-dst</td><td>`./src/index[j</td></tr></tbody></table><h5 class="anchor anchorWithStickyNavbar_rm_O" id="outputdir">outputDir<a class="hash-link" href="#outputdir" title="Direct link to heading">​</a></h5><ul><li>类型 <code>string</code></li><li>默认值 <code>es | lib | dist</code></li></ul><p>配置组件编译的出口。</p><table><thead><tr><th>任务</th><th>默认值</th></tr></thead><tbody><tr><td>component-es</td><td><code>es</code></td></tr><tr><td>component-esnext</td><td><code>esnext</code></td></tr><tr><td>component-lib</td><td><code>lib</code></td></tr><tr><td>component-dst</td><td><code>dist</code></td></tr></tbody></table><h5 class="anchor anchorWithStickyNavbar_rm_O" id="rollupplugins">rollupPlugins<a class="hash-link" href="#rollupplugins" title="Direct link to heading">​</a></h5><ul><li>类型 <code>array</code></li><li>默认值 <code>[]</code></li></ul><p>配置额外的 <a href="https://rollupjs.org/guide/en/#plugin-development" target="_blank" rel="noopener noreferrer">rollupPlugins</a>。</p><h5 class="anchor anchorWithStickyNavbar_rm_O" id="rollupoptions">rollupOptions<a class="hash-link" href="#rollupoptions" title="Direct link to heading">​</a></h5><ul><li>类型：<code>object</code></li><li>默认值 <code>{}</code></li></ul><p>当开启 <a href="#lib">lib</a> 选项，可通过 <code>rollupOptions</code> 配置额外的 <a href="https://rollupjs.org/guide/en/#command-line-flags" target="_blank" rel="noopener noreferrer">rollup 配置</a>。</p><p>当试图修改 <code>rollupOptions.plugins</code> 参数时，建议直接使用 <a href="#rollupPlugins">rollupPlugins</a> 参数。</p><h5 class="anchor anchorWithStickyNavbar_rm_O" id="swccompileoptions">swcCompileOptions<a class="hash-link" href="#swccompileoptions" title="Direct link to heading">​</a></h5><ul><li>类型 <code>array</code></li><li>默认值 <code>{}</code></li></ul><p>swc 编译选项。具体可参考 <a href="https://swc.rs/docs/configuration/swcrc" target="_blank" rel="noopener noreferrer">swc 配置</a>。</p><h4 class="anchor anchorWithStickyNavbar_rm_O" id="插件生命周期钩子">插件生命周期钩子<a class="hash-link" href="#插件生命周期钩子" title="Direct link to heading">​</a></h4><p><code>@ice/pkg-cli</code> 插件提供一下生命周期钩子：</p><ul><li>build 命令：</li></ul><table><thead><tr><th>生命周期</th><th>参数</th><th>调用时机</th></tr></thead><tbody><tr><td>before.build.load</td><td>{ args: CommandArgs; config: ComponentConfig[] }</td><td>获取所有任务配置后</td></tr><tr><td>before.build.run</td><td>{ args: CommandArgs; config: ComponentConfig[]  }</td><td>编译执行之前</td></tr><tr><td>after.build.compile</td><td>-</td><td>编译结束</td></tr><tr><td>error</td><td>{ errCode: string; err: Error }</td><td>错误</td></tr></tbody></table><ul><li>start 命令</li></ul><table><thead><tr><th>生命周期</th><th>参数</th><th>调用时机</th></tr></thead><tbody><tr><td>before.start.load</td><td>{ args: CommandArgs; config: ComponentConfig[] }</td><td>获取所有任务配置后</td></tr><tr><td>before.start.run</td><td>{ args: CommandArgs; config: ComponentConfig[]  }</td><td>编译执行之前</td></tr><tr><td>after.start.compile</td><td>-</td><td>编译结束</td></tr><tr><td>error</td><td>{ errCode: string; err: Error }</td><td>错误</td></tr></tbody></table><p>其他有关插件的使用可参考 <a href="https://github.com/ice-lab/build-scripts#%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91" target="_blank" rel="noopener noreferrer">build-scripts 插件开发</a>。</p><h3 class="anchor anchorWithStickyNavbar_rm_O" id="组件预览">组件预览<a class="hash-link" href="#组件预览" title="Direct link to heading">​</a></h3><p><code>@ice/pkg-cli</code> 依赖 <a href="https://github.com/ice-lab/component-next/tree/main/packages/plugin-docusaurus" target="_blank" rel="noopener noreferrer">@ice/pkg-plugin-docusaurus</a> 插件支持编写文档和预览组件，所有文档默认存放至 <code>docs</code> 文件夹下。支持以 <code>.md</code> 及 <code>.mdx</code> 为后缀的文档。用法：</p><div class="codeBlockContainer_Gn_p language-shell theme-code-block"><div class="codeBlockContent_Hbc5 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 若存在 docs 文件夹，则默认启动文档预览；并启动 es/lib 编译</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ pkg-cli start</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 不启动文档预览</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ pkg-cli start --doc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 若存在 docs 文件夹，则默认构建预览产物</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ pkg-cli build</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_rm_O" id="如何书写文档">如何书写文档<a class="hash-link" href="#如何书写文档" title="Direct link to heading">​</a></h4><p>文档以 <code>.md</code> 或 <code>.mdx</code> 为后缀，采用 <a href="https://yaml.org/" target="_blank" rel="noopener noreferrer">yaml</a> 和 <a href="https://daringfireball.net/projects/markdown/" target="_blank" rel="noopener noreferrer">markdown</a> 语法。</p><div class="codeBlockContainer_Gn_p language-markdown theme-code-block"><div class="codeBlockContent_Hbc5 markdown"><pre tabindex="0" class="prism-code language-markdown codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token front-matter-block punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token front-matter-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token front-matter-block"></span><span class="token front-matter-block front-matter yaml language-yaml">title: Simple Usage</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token front-matter-block front-matter yaml language-yaml">sidebar_position: 1</span><span class="token front-matter-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token front-matter-block"></span><span class="token front-matter-block punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token title important punctuation" style="color:rgb(199, 146, 234)">##</span><span class="token title important"> 本 Demo 演示一行文字的用法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token code punctuation" style="color:rgb(199, 146, 234)">```</span><span class="token code code-language">jsx</span><span class="token code"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token code"></span><span class="token code code-block language-jsx">import MyComponent from &#x27;my-component&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token code code-block language-jsx">import &#x27;./my-component.css&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token code code-block language-jsx" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token code code-block language-jsx">const App = () =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token code code-block language-jsx">  return (</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token code code-block language-jsx">    &lt;div&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token code code-block language-jsx">      &lt;MyComponent /&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token code code-block language-jsx">    &lt;/div&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token code code-block language-jsx">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token code code-block language-jsx">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token code code-block language-jsx" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token code code-block language-jsx">export default MyComponent;</span><span class="token code"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token code"></span><span class="token code punctuation" style="color:rgb(199, 146, 234)">```</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_rm_O" id="扁平结构">扁平结构<a class="hash-link" href="#扁平结构" title="Direct link to heading">​</a></h4><p>扁平结构的含义是可以将文档平铺在 <code>docs</code> 文件夹下：</p><div class="codeBlockContainer_Gn_p language-shell theme-code-block"><div class="codeBlockContent_Hbc5 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── index.md</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">└── intro.md</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_rm_O" id="嵌套结构">嵌套结构<a class="hash-link" href="#嵌套结构" title="Direct link to heading">​</a></h4><p>此外还支持嵌套结构，比如：</p><div class="codeBlockContainer_Gn_p language-shell theme-code-block"><div class="codeBlockContent_Hbc5 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── Foo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── Basic.md</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   └── Complex.md</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── index.md</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">└── intro.md</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_rm_O" id="文档排序">文档排序<a class="hash-link" href="#文档排序" title="Direct link to heading">​</a></h4><p>文档默认按照文件（或文件夹）的字母顺序进行排列。若要修改排列顺序，可通过下面两种方式。</p><ul><li>使用 <code>sidebar_position</code></li></ul><p>可以在文档头部使用 <a href="https://en.wikipedia.org/wiki/YAML" target="_blank" rel="noopener noreferrer">YAML</a> 标记顺序，比如想要将 <code>index.md</code> 设置为：</p><div class="codeBlockContainer_Gn_p language-markdown theme-code-block"><div class="codeBlockContent_Hbc5 markdown"><pre tabindex="0" class="prism-code language-markdown codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token front-matter-block punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token front-matter-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token front-matter-block"></span><span class="token front-matter-block front-matter yaml language-yaml">sidebar_position: 0</span><span class="token front-matter-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token front-matter-block"></span><span class="token front-matter-block punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token title important punctuation" style="color:rgb(199, 146, 234)">#</span><span class="token title important"> 这是首页，同时也是标题</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">在此处描述首页说明信息</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><ul><li>文档添加数字前缀</li></ul><div class="codeBlockContainer_Gn_p language-shell theme-code-block"><div class="codeBlockContent_Hbc5 shell"><pre tabindex="0" class="prism-code language-shell codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── 01-intro.md</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── 02-Foo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── 01-Basic.md</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   └── 02-Complex.md</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">└── index.md</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_rm_O" id="文档标题">文档标题<a class="hash-link" href="#文档标题" title="Direct link to heading">​</a></h4><p>文档会默认使用第一个 markdown 标题，作为文档的 title。此外，可以通过 yaml 语法来修改文档标题：</p><div class="codeBlockContainer_Gn_p language-markdown theme-code-block"><div class="codeBlockContent_Hbc5 markdown"><pre tabindex="0" class="prism-code language-markdown codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token front-matter-block punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token front-matter-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token front-matter-block"></span><span class="token front-matter-block front-matter yaml language-yaml">sidebar_label: 这是标题</span><span class="token front-matter-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token front-matter-block"></span><span class="token front-matter-block punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token title important punctuation" style="color:rgb(199, 146, 234)">#</span><span class="token title important"> 这里不再是默认标题了</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">在此处描述文档内容...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_rm_O" id="代码块">代码块<a class="hash-link" href="#代码块" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_rm_O" id="将代码渲染成组件">将代码渲染成组件<a class="hash-link" href="#将代码渲染成组件" title="Direct link to heading">​</a></h5><p>若想要预览组件，需要给代码块添加 <code>preview</code> 属性。下面展示的就是给代码块添加 preview 的效果。</p><div><div class="container_e_4U unfoldContainer_kr12"><div class="preview_lhAJ"> <div><button>Add count</button>;<p>0</p></div> </div><div class="__react_component_tooltip t08d9a46f-0729-4fcb-b368-892aed80c013 place-top type-dark" id="t08d9a46f-0729-4fcb-b368-892aed80c013" data-id="tooltip"><style aria-hidden="true">
  	.t08d9a46f-0729-4fcb-b368-892aed80c013 {
	    color: #fff;
	    background: #222;
	    border: 1px solid transparent;
  	}

  	.t08d9a46f-0729-4fcb-b368-892aed80c013.place-top {
        margin-top: -10px;
    }
    .t08d9a46f-0729-4fcb-b368-892aed80c013.place-top::before {
        border-top: 8px solid transparent;
    }
    .t08d9a46f-0729-4fcb-b368-892aed80c013.place-top::after {
        border-left: 8px solid transparent;
        border-right: 8px solid transparent;
        bottom: -6px;
        left: 50%;
        margin-left: -8px;
        border-top-color: #222;
        border-top-style: solid;
        border-top-width: 6px;
    }

    .t08d9a46f-0729-4fcb-b368-892aed80c013.place-bottom {
        margin-top: 10px;
    }
    .t08d9a46f-0729-4fcb-b368-892aed80c013.place-bottom::before {
        border-bottom: 8px solid transparent;
    }
    .t08d9a46f-0729-4fcb-b368-892aed80c013.place-bottom::after {
        border-left: 8px solid transparent;
        border-right: 8px solid transparent;
        top: -6px;
        left: 50%;
        margin-left: -8px;
        border-bottom-color: #222;
        border-bottom-style: solid;
        border-bottom-width: 6px;
    }

    .t08d9a46f-0729-4fcb-b368-892aed80c013.place-left {
        margin-left: -10px;
    }
    .t08d9a46f-0729-4fcb-b368-892aed80c013.place-left::before {
        border-left: 8px solid transparent;
    }
    .t08d9a46f-0729-4fcb-b368-892aed80c013.place-left::after {
        border-top: 5px solid transparent;
        border-bottom: 5px solid transparent;
        right: -6px;
        top: 50%;
        margin-top: -4px;
        border-left-color: #222;
        border-left-style: solid;
        border-left-width: 6px;
    }

    .t08d9a46f-0729-4fcb-b368-892aed80c013.place-right {
        margin-left: 10px;
    }
    .t08d9a46f-0729-4fcb-b368-892aed80c013.place-right::before {
        border-right: 8px solid transparent;
    }
    .t08d9a46f-0729-4fcb-b368-892aed80c013.place-right::after {
        border-top: 5px solid transparent;
        border-bottom: 5px solid transparent;
        left: -6px;
        top: 50%;
        margin-top: -4px;
        border-right-color: #222;
        border-right-style: solid;
        border-right-width: 6px;
    }
  </style></div><div class="operations_xyaT"><div class="item_SKCz"><svg viewBox="0 0 20 20" focusable="false" data-icon="snippets" width="20px" height="20px" fill="currentColor" aria-hidden="true"><path d="M15,5 L15,18 L2,18 L2,5 L15,5 Z M14,6 L3,6 L3,17 L14,17 L14,6 Z M18,2 L18,15 L16,15 L16,13.999 L17,14 L17,3 L6,3 L6,4 L5,4 L5,2 L18,2 Z M9,8 L9,11 L12,11 L12,12 L9,12 L9,15 L8,15 L8,12 L5,12 L5,11 L8,11 L8,8 L9,8 Z"></path></svg></div><div class="item_SKCz" data-tip="展开"><svg alt="expand code" width="20px" height="20px" viewBox="0 0 20 20" fill="currentColor"><path d="M14.4307124,13.5667899 L15.1349452,14.276759 L10.7473676,18.6288871 L6.42783259,14.2738791 L7.13782502,13.5696698 L10.7530744,17.2147744 L14.4307124,13.5667899 Z M4.79130753,8.067524 L16.3824174,11.1733525 L16.1235984,12.1392784 L4.53248848,9.03344983 L4.79130753,8.067524 Z M10.8154102,1.57503552 L15.1349452,5.93004351 L14.4249528,6.63425282 L10.809949,2.98914817 L7.13206544,6.6371327 L6.42783259,5.92716363 L10.8154102,1.57503552 Z" transform="translate(10.457453, 10.101961) rotate(90.000000) translate(-10.457453, -10.101961) "></path></svg></div></div></div><div class="codeWrapper_RVDT"></div></div><blockquote><p>需要注意的是，在 preview 的代码块中引入的样式会 <strong>污染</strong> 全局，因此建议使用 <a href="https://github.com/css-modules/css-modules" target="_blank" rel="noopener noreferrer">css-module</a> 或 <a href="https://cssinjs.org/" target="_blank" rel="noopener noreferrer">css-in-js</a> 等方式引入样式。</p></blockquote><h5 class="anchor anchorWithStickyNavbar_rm_O" id="给代码块添加-title">给代码块添加 title<a class="hash-link" href="#给代码块添加-title" title="Direct link to heading">​</a></h5><p>若想要给代码块添加 title，可以使用 <code>title</code> 属性。</p><div class="codeBlockContainer_Gn_p language-jsx theme-code-block"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_Xaeh">/src/components/index.js</div><div class="codeBlockContent_Hbc5 jsx"><pre tabindex="0" class="prism-code language-jsx codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> MyComponent </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;my-component&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_rm_O" id="插件配置">插件配置<a class="hash-link" href="#插件配置" title="Direct link to heading">​</a></h4><p><code>@ice/pkg-plugin-docusaurus</code> 插件接受如下配置：</p><div class="codeBlockContainer_Gn_p language-typescript theme-code-block"><div class="codeBlockContent_Hbc5 typescript"><pre tabindex="0" class="prism-code language-typescript codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">interface</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(255, 203, 107)">PluginDocusaurusOptions</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 文档的 title，默认为 &quot;飞冰组件&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  title</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 文档部署的顶层 url。比如部署在 github，则是 https://你的项目.github.io</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  url</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 文档路由的 baseUrl。</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  baseUrl</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 文档站点的 favicon 文件位置，默认为 static/img/favicon.ico</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  favicon</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 侧边栏 logo，默认为 static/img/logo.png</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  navBarLogo</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 侧边栏 title，默认为 &quot;飞冰组件&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  navBarTitle</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 文档启动的端口，默认为 4444</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  port</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">number</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 自定义 sidebar</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sidebarItemsGenerator</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><p>使用方式如下：</p><div class="codeBlockContainer_Gn_p language-ts theme-code-block"><div class="codeBlockContent_Hbc5 ts"><pre tabindex="0" class="prism-code language-ts codeBlock_E2JU thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_oSds"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> defineConfig </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@ice/pkg-cli&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">default</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">defineConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  plugins</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@ice/pkg-plugin-docusaurus&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      title</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;标题&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_MEDl clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_rm_O" id="自定义-docusaurus-能力">自定义 Docusaurus 能力<a class="hash-link" href="#自定义-docusaurus-能力" title="Direct link to heading">​</a></h4><p>若想要完整的 <a href="https://docusaurus.io/" target="_blank" rel="noopener noreferrer">Docusaurus</a> 能力，可在工程下自定义 <code>docusaurus.config.js</code>。具体的使用方式参考 <a href="https://docusaurus.io/" target="_blank" rel="noopener noreferrer">Docusaurus 文档</a>。</p><h2 class="anchor anchorWithStickyNavbar_rm_O" id="contributing">Contributing<a class="hash-link" href="#contributing" title="Direct link to heading">​</a></h2><p>Please see our <a href="https://github.com/ice-lab/pkg-cli/blob/master/.github/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer">CONTRIBUTING.md</a></p><h2 class="anchor anchorWithStickyNavbar_rm_O" id="license">License<a class="hash-link" href="#license" title="Direct link to heading">​</a></h2><p><a href="https://oss.ninja/mit/developit/" target="_blank" rel="noopener noreferrer">MIT</a></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_dMXi thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#这是什么" class="table-of-contents__link toc-highlight">这是什么</a></li><li><a href="#安装" class="table-of-contents__link toc-highlight">安装</a></li><li><a href="#使用" class="table-of-contents__link toc-highlight">使用</a><ul><li><a href="#命令行" class="table-of-contents__link toc-highlight">命令行</a></li><li><a href="#编写代码限制" class="table-of-contents__link toc-highlight">编写代码限制</a></li><li><a href="#package-exports" class="table-of-contents__link toc-highlight">Package Exports</a></li><li><a href="#自定义配置文件" class="table-of-contents__link toc-highlight">自定义配置文件</a></li><li><a href="#插件开发" class="table-of-contents__link toc-highlight">插件开发</a></li><li><a href="#组件预览" class="table-of-contents__link toc-highlight">组件预览</a></li></ul></li><li><a href="#contributing" class="table-of-contents__link toc-highlight">Contributing</a></li><li><a href="#license" class="table-of-contents__link toc-highlight">License</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.eabd1da0.js"></script>
<script src="/assets/js/main.be272e74.js"></script>
</body>
</html>